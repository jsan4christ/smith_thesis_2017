scale_color_manual(values = color_scheme_BCS)+
scale_x_continuous(breaks=c(0.5,1,4,8,11,13,16,19,22),minor_breaks = NULL,limits=c(0,22.5))+
scale_y_continuous(limits=c(0,102))
PLOT_SCRATCH.BETA
PLOT_SCRATCH.BETA<-
ggplot(scratch.summary.all,
aes(x=ExposureTime.n,y=mean,col=BCS))+
theme_bw()+
theme(plot.margin=unit(c(0,0,0,0),units = "pt"), text=element_text(size=16))+
geom_line(size=1.5,show.legend = F)+
geom_errorbar(aes(ymax=mean+sd,ymin=mean-sd),size=1,width=.5,show.legend = F)+
geom_point(size=6,show.legend = F)+
ylab("Filled Scratch Area (%)")+
mBio+
xlab("Exposure Time (hours)")+
scale_color_manual(values = color_scheme_BCS)+
scale_x_continuous(breaks=c(0.5,1,4,8,11,13,16,19,22),minor_breaks = NULL,limits=c(0,22.5))+
scale_y_continuous(limits=c(-10,102))
PLOT_SCRATCH.BETA
PLOT_SCRATCH.BETA<-
ggplot(scratch.summary.all,
aes(x=ExposureTime.n,y=mean,col=BCS))+
theme_bw()+
theme(plot.margin=unit(c(0,0,0,0),units = "pt"), text=element_text(size=16))+
geom_line(size=1.5,show.legend = F)+
geom_errorbar(aes(ymax=mean+sd,ymin=mean-sd),size=1,width=.5,show.legend = F)+
geom_point(size=6,show.legend = F)+
ylab("Filled Scratch Area (%)")+
mBio+
xlab("Exposure Time (hours)")+
scale_color_manual(values = color_scheme_BCS)+
scale_x_continuous(breaks=c(0.5,1,4,8,11,13,16,19,22),minor_breaks = NULL,limits=c(0,22.5))+
scale_y_continuous(limits=c(-5,102))
PLOT_SCRATCH.BETA
scratch.summary.all
min(scratch.summary.all$mean-scratch.summary.all$sd)
min(scratch.summary.all$mean-scratch.summary.all$sd,na.rm = T)
1.05*min(scratch.summary.all$mean-scratch.summary.all$sd,na.rm = T)
PLOT_SCRATCH.BETA<-
ggplot(scratch.summary.all,
aes(x=ExposureTime.n,y=mean,col=BCS))+
theme_bw()+
theme(plot.margin=unit(c(0,0,0,0),units = "pt"), text=element_text(size=16))+
geom_line(size=1.5,show.legend = F)+
geom_errorbar(aes(ymax=mean+sd,ymin=mean-sd),size=1,width=.5,show.legend = F)+
geom_point(size=6,show.legend = F)+
ylab("Filled Scratch Area (%)")+
mBio+
xlab("Exposure Time (hours)")+
scale_color_manual(values = color_scheme_BCS)+
scale_x_continuous(breaks=c(0.5,1,4,8,11,13,16,19,22),minor_breaks = NULL,limits=c(0,22.5))+
scale_y_continuous(limits=c(1.05*min(scratch.summary.all$mean-scratch.summary.all$sd,na.rm = T),102))
PLOT_SCRATCH.BETA
PLOT_SCRATCH.BETA<-
ggplot(scratch.summary.all,
aes(x=ExposureTime.n,y=mean,col=BCS))+
theme_bw()+
theme(plot.margin=unit(c(0,0,0,0),units = "pt"), text=element_text(size=16))+
geom_line(size=1.5,show.legend = F)+
geom_errorbar(aes(ymax=mean+sd,ymin=mean-sd),size=1,width=.5,show.legend = F)+
geom_point(size=6,show.legend = F)+
ylab("Filled Scratch Area (%)")+
mBio+
xlab("Exposure Time (hours)")+
scale_color_manual(values = color_scheme_BCS)+
scale_x_continuous(breaks=c(1,4,8,11,13,16,19,22),minor_breaks = NULL,limits=c(0,22.5))+
scale_y_continuous(limits=c(1.05*min(scratch.summary.all$mean-scratch.summary.all$sd,na.rm = T),102))
PLOT_SCRATCH.BETA<-
ggplot(scratch.summary.all,
aes(x=ExposureTime.n,y=mean,col=BCS))+
theme_bw()+
theme(plot.margin=unit(c(0,0,0,0),units = "pt"), text=element_text(size=16))+
geom_line(size=1.5,show.legend = F)+
geom_errorbar(aes(ymax=mean+sd,ymin=mean-sd),size=1,width=.5,show.legend = F)+
geom_point(size=6,show.legend = F)+
ylab("Filled Scratch Area (%)")+
mBio+
xlab("Exposure Time (hours)")+
scale_color_manual(values = color_scheme_BCS)+
scale_x_continuous(breaks=c(1,4,8,13,16,19,22),minor_breaks = NULL,limits=c(0,22.5))+
scale_y_continuous(limits=c(1.05*min(scratch.summary.all$mean-scratch.summary.all$sd,na.rm = T),102))
PLOT_SCRATCH.BETA
PLOT_SCRATCH.BETA<-
ggplot(scratch.summary.all,
aes(x=ExposureTime.n,y=mean,col=BCS))+
theme_bw()+
theme(plot.margin=unit(c(0,0,0,0),units = "pt"), text=element_text(size=16))+
geom_line(size=1.5,show.legend = F)+
geom_errorbar(aes(ymax=mean+sd,ymin=mean-sd),size=1,width=.5,show.legend = F)+
geom_point(size=6,show.legend = F)+
ylab("Filled Scratch Area (%)")+
mBio+
xlab("Exposure Time (hours)")+
scale_color_manual(values = color_scheme_BCS)+
scale_x_continuous(breaks=c(1,4,8,13,16,19,22),minor_breaks = NULL,limits=c(0,22.5))+
scale_y_continuous(limits=c(1.05*min(scratch.summary.all$mean-scratch.summary.all$sd,na.rm = T),102))
cairo_ps(paste0(thesis_figures_directory,FIGURE_SCRATCH_QUANT),width = 8,height = 5.5)
plot(PLOT_SCRATCH.BETA) #plot(plot_scratch.prolif)
dev.off()
FIGURE_SCRATCH_QUANT
root_directory<-"~/smith_thesis_2017/PreparePipeline/"
R_script_input_directory<-"~/smith_thesis_2017/AnalysisPipeline/Script_input/"
in_vitro_experiments<-read.csv(paste0(root_directory,"In_vitro_Experiments.csv")) ## pre-compiled csv datatable.
control_meds<-filter(in_vitro_experiments,grepl(x = as.character(in_vitro_experiments$Treatment),pattern = "CONTROL_"))
control_meds
EdU.summary
EdU.m<-filter(in_vitro_experiments,Experiment=="Scratch" & Observation == "EdU") %>% dplyr::select(-c(Experiment)) #melt(scratch)
EdU.m<-rename(EdU.m,BCS=Treatment)
EdU.m$BCS
EdU.m$BCS<-factor(EdU.m$BCS,ordered = T,levels = c("L. crispatus","L. jensenii","L. iners","G. vaginalis","Cell Culture Medium","0.1% DL lactic acid"))
EdU.m$percent_cells<-EdU.m$percent_cells+abs(rnorm(nrow(EdU.m),1E-3,0.01))
statbars<-EdU_sigtest<-statbars2<-EdU.summary<-data.frame(temp="NA")
for(et in c("1hr","4hr","8hr","13hr","16hr","19hr","22hr")){
## Create a significance testing data frame to hold results
setup_sigtest.data<-setup_sigtest(pval_threshold = pval_threshold,raw_data = dplyr::filter(EdU.m,ExposureTime==et),test_function = "t.test",Experiment = "Scratch")
statbars<-rbind.fill(data.frame(setup_sigtest.data$statbars,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),statbars)
statbars2<-rbind.fill(data.frame(setup_sigtest.data$statbars2,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),statbars2)
EdU_sigtest<-rbind.fill(data.frame(setup_sigtest.data$sigtest,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),EdU_sigtest)
EdU.summary<-rbind.fill(data.frame(setup_sigtest.data$summary_stats,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),EdU.summary)
}
setup_sigtest.data
et
root_directory<-"~/smith_thesis_2017/PreparePipeline/"
R_script_input_directory<-"~/smith_thesis_2017/AnalysisPipeline/Script_input/"
in_vitro_experiments<-read.csv(paste0(root_directory,"In_vitro_Experiments.csv")) ## pre-compiled csv datatable.
EdU.m<-filter(in_vitro_experiments,Experiment=="Scratch" & Observation == "EdU") %>% dplyr::select(-c(Experiment)) #melt(scratch)
EdU.m<-rename(EdU.m,BCS=Treatment)
EdU.m$BCS<-factor(EdU.m$BCS,ordered = T,levels = c("L. crispatus","L. jensenii","L. iners","G. vaginalis","Cell Culture Medium","0.1% DL lactic acid"))
EdU.m$percent_cells<-EdU.m$percent_cells+abs(rnorm(nrow(EdU.m),1E-3,0.01))
statbars<-EdU_sigtest<-statbars2<-EdU.summary<-data.frame(temp="NA")
for(et in c("1hr","4hr","8hr","13hr","16hr","19hr","22hr")){
## Create a significance testing data frame to hold results
setup_sigtest.data<-setup_sigtest(pval_threshold = pval_threshold,raw_data = dplyr::filter(EdU.m,ExposureTime==et),test_function = "t.test",Experiment = "Scratch")
statbars<-rbind.fill(data.frame(setup_sigtest.data$statbars,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),statbars)
statbars2<-rbind.fill(data.frame(setup_sigtest.data$statbars2,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),statbars2)
EdU_sigtest<-rbind.fill(data.frame(setup_sigtest.data$sigtest,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),EdU_sigtest)
EdU.summary<-rbind.fill(data.frame(setup_sigtest.data$summary_stats,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),EdU.summary)
}
et
EdU.m
dplyr::filter(EdU.m,ExposureTime==et)
root_directory<-"~/smith_thesis_2017/PreparePipeline/"
R_script_input_directory<-"~/smith_thesis_2017/AnalysisPipeline/Script_input/"
in_vitro_experiments<-read.csv(paste0(root_directory,"In_vitro_Experiments.csv")) ## pre-compiled csv datatable.
EdU.m<-filter(in_vitro_experiments,Experiment=="Scratch" & Observation == "EdU") %>% dplyr::select(-c(Experiment)) #melt(scratch)
EdU.m<-rename(EdU.m,BCS=Treatment)
EdU.m$BCS<-factor(EdU.m$BCS,ordered = T,levels = c("L. crispatus","L. jensenii","L. iners","G. vaginalis","Cell Culture Medium","0.1% DL lactic acid"))
for(et in c("0.5hr","1hr","4hr","8hr","13hr","16hr","19hr","22hr")){
## Create a significance testing data frame to hold results
setup_sigtest.data<-setup_sigtest(pval_threshold = pval_threshold,raw_data = dplyr::filter(EdU.m,ExposureTime==et),test_function = "t.test",Experiment = "Scratch")
statbars<-rbind.fill(data.frame(setup_sigtest.data$statbars,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),statbars)
statbars2<-rbind.fill(data.frame(setup_sigtest.data$statbars2,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),statbars2)
EdU_sigtest<-rbind.fill(data.frame(setup_sigtest.data$sigtest,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),EdU_sigtest)
EdU.summary<-rbind.fill(data.frame(setup_sigtest.data$summary_stats,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),EdU.summary)
}
et
dplyr::filter(EdU.m,ExposureTime==et)
for(et in c("1hr","4hr","8hr","13hr","16hr","19hr","22hr")){
## Create a significance testing data frame to hold results
setup_sigtest.data<-setup_sigtest(pval_threshold = pval_threshold,raw_data = dplyr::filter(EdU.m,ExposureTime==et),test_function = "t.test",Experiment = "Scratch")
statbars<-rbind.fill(data.frame(setup_sigtest.data$statbars,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),statbars)
statbars2<-rbind.fill(data.frame(setup_sigtest.data$statbars2,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),statbars2)
EdU_sigtest<-rbind.fill(data.frame(setup_sigtest.data$sigtest,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),EdU_sigtest)
EdU.summary<-rbind.fill(data.frame(setup_sigtest.data$summary_stats,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),EdU.summary)
}
et
dplyr::filter(EdU.m,ExposureTime==et)
setup_sigtest.data<-setup_sigtest(pval_threshold = pval_threshold,raw_data = dplyr::filter(EdU.m,ExposureTime==et),test_function = "t.test",Experiment = "Scratch")
dplyr::filter(EdU.m,ExposureTime==et)
EdU.m$percent_cells<-EdU.m$percent_cells+abs(rnorm(nrow(EdU.m),1E-3,0.01))
EdU.m<-filter(in_vitro_experiments,Experiment=="Scratch" & Observation == "EdU") %>% dplyr::select(-c(Experiment)) #melt(scratch)
EdU.m<-rename(EdU.m,BCS=Treatment)
EdU.m$BCS<-factor(EdU.m$BCS,ordered = T,levels = c("L. crispatus","L. jensenii","L. iners","G. vaginalis","Cell Culture Medium","0.1% DL lactic acid"))
EdU.m$percent_cells<-EdU.m$percent_cells+abs(rnorm(nrow(EdU.m),1E-3,0.01))
EdU.m
statbars<-EdU_sigtest<-statbars2<-EdU.summary<-data.frame(temp="NA")
for(et in c("1hr","4hr","8hr","13hr","16hr","19hr","22hr")){
## Create a significance testing data frame to hold results
setup_sigtest.data<-setup_sigtest(pval_threshold = pval_threshold,raw_data = dplyr::filter(EdU.m,ExposureTime==et),test_function = "t.test",Experiment = "Scratch")
statbars<-rbind.fill(data.frame(setup_sigtest.data$statbars,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),statbars)
statbars2<-rbind.fill(data.frame(setup_sigtest.data$statbars2,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),statbars2)
EdU_sigtest<-rbind.fill(data.frame(setup_sigtest.data$sigtest,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),EdU_sigtest)
EdU.summary<-rbind.fill(data.frame(setup_sigtest.data$summary_stats,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),EdU.summary)
}
et
dplyr::filter(EdU.m,ExposureTime==et)
EdU.m<-filter(in_vitro_experiments,Experiment=="Scratch" & Observation == "EdU") %>% dplyr::select(-c(Experiment)) #melt(scratch)
EdU.m<-rename(EdU.m,BCS=Treatment)
EdU.m$BCS
factor(EdU.m$BCS,ordered = T,levels = c("L. crispatus","L. jensenii","L. iners","G. vaginalis","Cell Culture Medium","0.1% DL lactic acid"))
EdU.m$BCS
factor(EdU.m$BCS,ordered = T,levels = c("L. crispatus","L. jensenii","L. iners","G. vaginalis","Cell Culture Medium","0.1% DL lactic acid"))
EdU.m$BCS<-factor(EdU.m$BCS,ordered = T,levels = c("L. crispatus","L. jensenii","L. iners","G. vaginalis","Cell Culture Medium","0.1% DL lactic acid"))
EdU.m$percent_cells<-EdU.m$percent_cells+abs(rnorm(nrow(EdU.m),1E-3,0.01))
statbars<-EdU_sigtest<-statbars2<-EdU.summary<-data.frame(temp="NA")
EdU_sigtest
for(et in c("1hr","4hr","8hr","13hr","16hr","19hr","22hr")){
## Create a significance testing data frame to hold results
setup_sigtest.data<-setup_sigtest(pval_threshold = pval_threshold,raw_data = dplyr::filter(EdU.m,ExposureTime==et),test_function = "t.test",Experiment = "Scratch")
statbars<-rbind.fill(data.frame(setup_sigtest.data$statbars,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),statbars)
statbars2<-rbind.fill(data.frame(setup_sigtest.data$statbars2,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),statbars2)
EdU_sigtest<-rbind.fill(data.frame(setup_sigtest.data$sigtest,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),EdU_sigtest)
EdU.summary<-rbind.fill(data.frame(setup_sigtest.data$summary_stats,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),EdU.summary)
}
setup_sigtest.data
dplyr::filter(EdU.m,ExposureTime==et)
root_directory<-"~/smith_thesis_2017/PreparePipeline/"
R_script_input_directory<-"~/smith_thesis_2017/AnalysisPipeline/Script_input/"
in_vitro_experiments<-read.csv(paste0(root_directory,"In_vitro_Experiments.csv")) ## pre-compiled csv datatable.
EdU.m<-filter(in_vitro_experiments,Experiment=="Scratch" & Observation == "EdU") %>% dplyr::select(-c(Experiment)) #melt(scratch)
EdU.m<-rename(EdU.m,BCS=Treatment)
EdU.m$BCS<-factor(EdU.m$BCS,ordered = T,levels = c("L. crispatus","L. jensenii","L. iners","G. vaginalis","Cell Culture Medium","0.1% DL lactic acid"))
EdU.m$percent_cells<-EdU.m$percent_cells+abs(rnorm(nrow(EdU.m),1E-3,0.01))
statbars<-EdU_sigtest<-statbars2<-EdU.summary<-data.frame(temp="NA")
for(et in c("1hr","4hr","8hr","13hr","16hr","19hr","22hr")){
## Create a significance testing data frame to hold results
setup_sigtest.data<-setup_sigtest(pval_threshold = pval_threshold,raw_data = dplyr::filter(EdU.m,ExposureTime==et),test_function = "t.test",Experiment = "Scratch")
statbars<-rbind.fill(data.frame(setup_sigtest.data$statbars,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),statbars)
statbars2<-rbind.fill(data.frame(setup_sigtest.data$statbars2,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),statbars2)
EdU_sigtest<-rbind.fill(data.frame(setup_sigtest.data$sigtest,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),EdU_sigtest)
EdU.summary<-rbind.fill(data.frame(setup_sigtest.data$summary_stats,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),EdU.summary)
}
et
dplyr::filter(EdU.m,ExposureTime==et)
root_directory<-"~/smith_thesis_2017/PreparePipeline/"
R_script_input_directory<-"~/smith_thesis_2017/AnalysisPipeline/Script_input/"
in_vitro_experiments<-read.csv(paste0(root_directory,"In_vitro_Experiments.csv")) ## pre-compiled csv datatable.
EdU.m<-filter(in_vitro_experiments,Experiment=="Scratch" & Observation == "EdU") %>% dplyr::select(-c(Experiment)) #melt(scratch)
EdU.m<-rename(EdU.m,BCS=Treatment)
EdU.m$BCS<-factor(EdU.m$BCS,ordered = T,levels = c("L. crispatus","L. jensenii","L. iners","G. vaginalis","Cell Culture Medium","0.1% DL lactic acid"))
EdU.m$percent_cells<-EdU.m$percent_cells+abs(rnorm(nrow(EdU.m),1E-3,0.01))
statbars<-EdU_sigtest<-statbars2<-EdU.summary<-data.frame(temp="NA")
for(et in c("1hr","4hr","8hr","13hr","16hr","19hr","22hr")){
## Create a significance testing data frame to hold results
setup_sigtest.data<-setup_sigtest(pval_threshold = pval_threshold,raw_data = dplyr::filter(EdU.m,ExposureTime==et),test_function = "t.test",Experiment = "Scratch")
statbars<-rbind.fill(data.frame(setup_sigtest.data$statbars,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),statbars)
statbars2<-rbind.fill(data.frame(setup_sigtest.data$statbars2,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),statbars2)
EdU_sigtest<-rbind.fill(data.frame(setup_sigtest.data$sigtest,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),EdU_sigtest)
EdU.summary<-rbind.fill(data.frame(setup_sigtest.data$summary_stats,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),EdU.summary)
}
R_script_input_directory
load(file=paste0(R_script_input_directory,"In_Vitro_Experiments.Rdata"))
R_script_input_directory
in_vitro_experiments
write.csv(in_vitro_experiments,file = "~/Desktop/in_vitro_experiments.csv")
scratch.m<-filter(in_vitro_experiments,Experiment=="Scratch" & Observation == "Proliferation" & !grepl(x = as.character(in_vitro_experiments$Treatment),pattern = "CONTROL_")) %>% dplyr::select(-c(Experiment,Coverslip))
tail(in_vitro_experiments,n = 20)
names(scratch.m)<-c("Observation","BCS","ExposureTime","percent_cells","Field")
scratch.m$BCS<-factor(scratch.m$BCS,ordered = T,levels = c("L. crispatus","L. jensenii","L. iners","G. vaginalis","Cell Culture Medium","0.1% DL lactic acid"))
scratch_sigtest.all<-data.frame(temp<-"NA")
scratch.summary.all<-data.frame(temp<-"NA")
for(et in c("1hr","4hr","8hr","13hr","16hr","19hr","22hr")){
##FIXME this is sloppy
##Ignore sig tests for now since the plots are clearly sig... too many comparisons
## Create a significance testing data frame to hold results
setup_sigtest.data<-setup_sigtest(pval_threshold = pval_threshold,raw_data = dplyr::filter(scratch.m,ExposureTime==et),test_function = "t.test",Experiment = "Scratch")
scratch_sigtest<-setup_sigtest.data$sigtest
scratch_sigtest$ExposureTime<-et
scratch.summary<-setup_sigtest.data$summary_stats
scratch.summary$ExposureTime.n<-as.numeric(gsub(et,pattern = "hr",replacement = ""))
scratch_sigtest.all<-rbind.fill(scratch_sigtest,scratch_sigtest.all)
scratch.summary.all<-rbind.fill(scratch.summary,scratch.summary.all)
}
et
dplyr::filter(scratch.m,ExposureTime==et)
load(paste0(R_script_input_directory,"In_Vitro_Experiments.Rdata"))
in_vitro_experiments
in_vitro_experiments
write.csv(in_vitro_experiments,"~/Desktop/inv.csv")
scratch.m<-filter(in_vitro_experiments,Experiment=="Scratch" & Observation == "Proliferation" & !grepl(x = as.character(in_vitro_experiments$Treatment),pattern = "CONTROL_")) %>% dplyr::select(-c(Experiment,Coverslip))
tail(in_vitro_experiments,n = 20)
names(scratch.m)<-c("Observation","BCS","ExposureTime","percent_cells","Field")
scratch.m$BCS<-factor(scratch.m$BCS,ordered = T,levels = c("L. crispatus","L. jensenii","L. iners","G. vaginalis","Cell Culture Medium","0.1% DL lactic acid"))
scratch_sigtest.all<-data.frame(temp<-"NA")
scratch.summary.all<-data.frame(temp<-"NA")
for(et in c("1hr","4hr","8hr","13hr","16hr","19hr","22hr")){
##FIXME this is sloppy
##Ignore sig tests for now since the plots are clearly sig... too many comparisons
## Create a significance testing data frame to hold results
setup_sigtest.data<-setup_sigtest(pval_threshold = pval_threshold,raw_data = dplyr::filter(scratch.m,ExposureTime==et),test_function = "t.test",Experiment = "Scratch")
scratch_sigtest<-setup_sigtest.data$sigtest
scratch_sigtest$ExposureTime<-et
scratch.summary<-setup_sigtest.data$summary_stats
scratch.summary$ExposureTime.n<-as.numeric(gsub(et,pattern = "hr",replacement = ""))
scratch_sigtest.all<-rbind.fill(scratch_sigtest,scratch_sigtest.all)
scratch.summary.all<-rbind.fill(scratch.summary,scratch.summary.all)
}
et
dplyr::filter(scratch.m,ExposureTime==et)
for(et in c("4hr","8hr","13hr","16hr","19hr","22hr")){
##FIXME this is sloppy
##Ignore sig tests for now since the plots are clearly sig... too many comparisons
## Create a significance testing data frame to hold results
setup_sigtest.data<-setup_sigtest(pval_threshold = pval_threshold,raw_data = dplyr::filter(scratch.m,ExposureTime==et),test_function = "t.test",Experiment = "Scratch")
scratch_sigtest<-setup_sigtest.data$sigtest
scratch_sigtest$ExposureTime<-et
scratch.summary<-setup_sigtest.data$summary_stats
scratch.summary$ExposureTime.n<-as.numeric(gsub(et,pattern = "hr",replacement = ""))
scratch_sigtest.all<-rbind.fill(scratch_sigtest,scratch_sigtest.all)
scratch.summary.all<-rbind.fill(scratch.summary,scratch.summary.all)
}
root_directory<-"~/smith_thesis_2017/PreparePipeline/"
R_script_input_directory<-"~/smith_thesis_2017/AnalysisPipeline/Script_input/"
in_vitro_experiments<-read.csv(paste0(root_directory,"In_vitro_Experiments.csv")) ## pre-compiled csv datatable.
in_vitro_experiments
scratch.m<-filter(in_vitro_experiments,Experiment=="Scratch" & Observation == "Proliferation" & !grepl(x = as.character(in_vitro_experiments$Treatment),pattern = "CONTROL_")) %>% dplyr::select(-c(Experiment,Coverslip))
tail(in_vitro_experiments,n = 20)
names(scratch.m)<-c("Observation","BCS","ExposureTime","percent_cells","Field")
scratch.m$BCS<-factor(scratch.m$BCS,ordered = T,levels = c("L. crispatus","L. jensenii","L. iners","G. vaginalis","Cell Culture Medium","0.1% DL lactic acid"))
scratch_sigtest.all<-data.frame(temp<-"NA")
scratch.summary.all<-data.frame(temp<-"NA")
for(et in c("1hr","4hr","8hr","13hr","16hr","19hr","22hr")){
##FIXME this is sloppy
##Ignore sig tests for now since the plots are clearly sig... too many comparisons
## Create a significance testing data frame to hold results
setup_sigtest.data<-setup_sigtest(pval_threshold = pval_threshold,raw_data = dplyr::filter(scratch.m,ExposureTime==et),test_function = "t.test",Experiment = "Scratch")
scratch_sigtest<-setup_sigtest.data$sigtest
scratch_sigtest$ExposureTime<-et
scratch.summary<-setup_sigtest.data$summary_stats
scratch.summary$ExposureTime.n<-as.numeric(gsub(et,pattern = "hr",replacement = ""))
scratch_sigtest.all<-rbind.fill(scratch_sigtest,scratch_sigtest.all)
scratch.summary.all<-rbind.fill(scratch.summary,scratch.summary.all)
}
PLOT_SCRATCH.BETA<-
ggplot(scratch.summary.all,
aes(x=ExposureTime.n,y=mean,col=BCS))+
theme_bw()+
theme(plot.margin=unit(c(0,0,0,0),units = "pt"), text=element_text(size=16))+
geom_line(size=1.5,show.legend = F)+
geom_errorbar(aes(ymax=mean+sd,ymin=mean-sd),size=1,width=.5,show.legend = F)+
geom_point(size=6,show.legend = F)+
ylab("Filled Scratch Area (%)")+
mBio+
xlab("Exposure Time (hours)")+
scale_color_manual(values = color_scheme_BCS)+
scale_x_continuous(breaks=c(1,4,8,13,16,19,22),minor_breaks = NULL,limits=c(0,22.5))+
scale_y_continuous(limits=c(1.05*min(scratch.summary.all$mean-scratch.summary.all$sd,na.rm = T),102))
PLOT_SCRATCH.BETA
root_directory<-"~/smith_thesis_2017/PreparePipeline/"
R_script_input_directory<-"~/smith_thesis_2017/AnalysisPipeline/Script_input/"
in_vitro_experiments<-read.csv(paste0(root_directory,"In_vitro_Experiments.csv")) ## pre-compiled csv datatable.
scratch.m$BCS<-factor(scratch.m$BCS,ordered = T,levels = c("L. crispatus","L. jensenii","L. iners","G. vaginalis","Cell Culture Medium","0.1% DL lactic acid"))
scratch_sigtest.all<-data.frame(temp<-"NA")
scratch.summary.all<-data.frame(temp<-"NA")
for(et in c("1hr","4hr","8hr","13hr","16hr","19hr","22hr")){
##FIXME this is sloppy
##Ignore sig tests for now since the plots are clearly sig... too many comparisons
## Create a significance testing data frame to hold results
setup_sigtest.data<-setup_sigtest(pval_threshold = pval_threshold,raw_data = dplyr::filter(scratch.m,ExposureTime==et),test_function = "t.test",Experiment = "Scratch")
scratch_sigtest<-setup_sigtest.data$sigtest
scratch_sigtest$ExposureTime<-et
scratch.summary<-setup_sigtest.data$summary_stats
scratch.summary$ExposureTime.n<-as.numeric(gsub(et,pattern = "hr",replacement = ""))
scratch_sigtest.all<-rbind.fill(scratch_sigtest,scratch_sigtest.all)
scratch.summary.all<-rbind.fill(scratch.summary,scratch.summary.all)
}
PLOT_SCRATCH.BETA<-
ggplot(scratch.summary.all,
aes(x=ExposureTime.n,y=mean,col=BCS))+
theme_bw()+
theme(plot.margin=unit(c(0,0,0,0),units = "pt"), text=element_text(size=16))+
geom_line(size=1.5,show.legend = F)+
geom_errorbar(aes(ymax=mean+sd,ymin=mean-sd),size=1,width=.5,show.legend = F)+
geom_point(size=6,show.legend = F)+
ylab("Filled Scratch Area (%)")+
mBio+
xlab("Exposure Time (hours)")+
scale_color_manual(values = color_scheme_BCS)+
scale_x_continuous(breaks=c(1,4,8,13,16,19,22),minor_breaks = NULL,limits=c(0,22.5))+
scale_y_continuous(limits=c(1.05*min(scratch.summary.all$mean-scratch.summary.all$sd,na.rm = T),102))
PLOT_SCRATCH.BETA
EdU.m<-filter(in_vitro_experiments,Experiment=="Scratch" & Observation == "EdU") %>% dplyr::select(-c(Experiment)) #melt(scratch)
EdU.m<-rename(EdU.m,BCS=Treatment)
EdU.m$BCS<-factor(EdU.m$BCS,ordered = T,levels = c("L. crispatus","L. jensenii","L. iners","G. vaginalis","Cell Culture Medium","0.1% DL lactic acid"))
EdU.m$BCS
for(et in c("1hr","4hr","8hr","13hr","16hr","19hr","22hr")){
## Create a significance testing data frame to hold results
setup_sigtest.data<-setup_sigtest(pval_threshold = pval_threshold,raw_data = dplyr::filter(EdU.m,ExposureTime==et),test_function = "t.test",Experiment = "Scratch")
statbars<-rbind.fill(data.frame(setup_sigtest.data$statbars,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),statbars)
statbars2<-rbind.fill(data.frame(setup_sigtest.data$statbars2,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),statbars2)
EdU_sigtest<-rbind.fill(data.frame(setup_sigtest.data$sigtest,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),EdU_sigtest)
EdU.summary<-rbind.fill(data.frame(setup_sigtest.data$summary_stats,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),EdU.summary)
}
et
dplyr::filter(EdU.m,ExposureTime==et)
EdU.m$percent_cells<-EdU.m$percent_cells+abs(rnorm(nrow(EdU.m),1E-3,0.01))
statbars<-EdU_sigtest<-statbars2<-EdU.summary<-data.frame(temp="NA")
for(et in c("1hr","4hr","8hr","13hr","16hr","19hr","22hr")){
## Create a significance testing data frame to hold results
setup_sigtest.data<-setup_sigtest(pval_threshold = pval_threshold,raw_data = dplyr::filter(EdU.m,ExposureTime==et),test_function = "t.test",Experiment = "Scratch")
statbars<-rbind.fill(data.frame(setup_sigtest.data$statbars,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),statbars)
statbars2<-rbind.fill(data.frame(setup_sigtest.data$statbars2,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),statbars2)
EdU_sigtest<-rbind.fill(data.frame(setup_sigtest.data$sigtest,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),EdU_sigtest)
EdU.summary<-rbind.fill(data.frame(setup_sigtest.data$summary_stats,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),EdU.summary)
}
et
dplyr::filter(EdU.m,ExposureTime==et)
EdU.m<-filter(in_vitro_experiments,Experiment=="Scratch" & Observation == "EdU") %>% dplyr::select(-c(Experiment)) #melt(scratch)
EdU.m<-rename(EdU.m,BCS=Treatment)
EdU.m$BCS<-factor(EdU.m$BCS,ordered = T,levels = c("L. crispatus","L. jensenii","L. iners","G. vaginalis","Cell Culture Medium","0.1% DL lactic acid"))
dplyr::filter(EdU.m,ExposureTime==et)
root_directory<-"~/smith_thesis_2017/PreparePipeline/"
R_script_input_directory<-"~/smith_thesis_2017/AnalysisPipeline/Script_input/"
in_vitro_experiments<-read.csv(paste0(root_directory,"In_vitro_Experiments.csv")) ## pre-compiled csv datatable.
EdU.m<-filter(in_vitro_experiments,Experiment=="Scratch" & Observation == "EdU") %>% dplyr::select(-c(Experiment)) #melt(scratch)
EdU.m<-rename(EdU.m,BCS=Treatment)
EdU.m$BCS<-factor(EdU.m$BCS,ordered = T,levels = c("L. crispatus","L. jensenii","L. iners","G. vaginalis","Cell Culture Medium","0.1% DL lactic acid"))
EdU.m$percent_cells<-EdU.m$percent_cells+abs(rnorm(nrow(EdU.m),1E-3,0.01))
statbars<-EdU_sigtest<-statbars2<-EdU.summary<-data.frame(temp="NA")
for(et in c("1hr","4hr","8hr","13hr","16hr","19hr","22hr")){
## Create a significance testing data frame to hold results
setup_sigtest.data<-setup_sigtest(pval_threshold = pval_threshold,raw_data = dplyr::filter(EdU.m,ExposureTime==et),test_function = "t.test",Experiment = "Scratch")
statbars<-rbind.fill(data.frame(setup_sigtest.data$statbars,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),statbars)
statbars2<-rbind.fill(data.frame(setup_sigtest.data$statbars2,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),statbars2)
EdU_sigtest<-rbind.fill(data.frame(setup_sigtest.data$sigtest,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),EdU_sigtest)
EdU.summary<-rbind.fill(data.frame(setup_sigtest.data$summary_stats,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),EdU.summary)
}
et
dplyr::filter(EdU.m,ExposureTime==et)
dplyr::filter(EdU.m,ExposureTime==et)
EdU.m<-filter(in_vitro_experiments,Experiment=="Scratch" & Observation == "EdU") %>% dplyr::select(-c(Experiment)) #melt(scratch)
EdU.m
EdU.m<-rename(EdU.m,BCS=Treatment)
EdU.m$BCS<-factor(EdU.m$BCS,ordered = T,levels = c("L. crispatus","L. jensenii","L. iners","G. vaginalis","Cell Culture Medium","0.1% DL lactic acid"))
EdU.m$percent_cells<-EdU.m$percent_cells+abs(rnorm(nrow(EdU.m),1E-3,0.01))
statbars<-EdU_sigtest<-statbars2<-EdU.summary<-data.frame(temp="NA")
for(et in c("1hr","4hr","8hr","13hr","16hr","19hr","22hr")){
## Create a significance testing data frame to hold results
setup_sigtest.data<-setup_sigtest(pval_threshold = pval_threshold,raw_data = dplyr::filter(EdU.m,ExposureTime==et),test_function = "t.test",Experiment = "Scratch")
statbars<-rbind.fill(data.frame(setup_sigtest.data$statbars,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),statbars)
statbars2<-rbind.fill(data.frame(setup_sigtest.data$statbars2,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),statbars2)
EdU_sigtest<-rbind.fill(data.frame(setup_sigtest.data$sigtest,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),EdU_sigtest)
EdU.summary<-rbind.fill(data.frame(setup_sigtest.data$summary_stats,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),EdU.summary)
}
dplyr::filter(EdU.m,ExposureTime==et)
root_directory<-"~/smith_thesis_2017/PreparePipeline/"
R_script_input_directory<-"~/smith_thesis_2017/AnalysisPipeline/Script_input/"
in_vitro_experiments<-read.csv(paste0(root_directory,"In_vitro_Experiments.csv")) ## pre-compiled csv datatable.
EdU.m<-filter(in_vitro_experiments,Experiment=="Scratch" & Observation == "EdU") %>% dplyr::select(-c(Experiment)) #melt(scratch)
EdU.m<-rename(EdU.m,BCS=Treatment)
EdU.m$BCS<-factor(EdU.m$BCS,ordered = T,levels = c("L. crispatus","L. jensenii","L. iners","G. vaginalis","Cell Culture Medium","0.1% DL lactic acid"))
EdU.m$percent_cells<-EdU.m$percent_cells+abs(rnorm(nrow(EdU.m),1E-3,0.01))
statbars<-EdU_sigtest<-statbars2<-EdU.summary<-data.frame(temp="NA")
for(et in c("1hr","4hr","8hr","13hr","16hr","19hr","22hr")){
## Create a significance testing data frame to hold results
setup_sigtest.data<-setup_sigtest(pval_threshold = pval_threshold,raw_data = dplyr::filter(EdU.m,ExposureTime==et),test_function = "t.test",Experiment = "Scratch")
statbars<-rbind.fill(data.frame(setup_sigtest.data$statbars,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),statbars)
statbars2<-rbind.fill(data.frame(setup_sigtest.data$statbars2,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),statbars2)
EdU_sigtest<-rbind.fill(data.frame(setup_sigtest.data$sigtest,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),EdU_sigtest)
EdU.summary<-rbind.fill(data.frame(setup_sigtest.data$summary_stats,ExposureTime=as.numeric(gsub(et,pattern = "hr",replacement = ""))),EdU.summary)
}
PLOT_EDU.BETA<-
ggplot(EdU.summary,
aes(x=ExposureTime,y=mean,col=BCS))+
theme_bw()+
theme(plot.margin=unit(c(0,0,0,0),units = "pt"), text=element_text(size=16))+
geom_line(size=1.5,show.legend = F)+
geom_errorbar(aes(ymax=mean+sd,ymin=mean-sd),size=1,width=.5,show.legend = F)+
geom_point(size=6,show.legend = F)+
mBio+
ylab("Epithelial Cells Positive for EdU (%)")+
xlab("Exposure Time (hours)")+
scale_color_manual(values = color_scheme_BCS)+
scale_x_continuous(breaks=c(0.5,1,4,8,11,13,16,19,22),minor_breaks = NULL,limits=c(0,22.5))+
scale_y_continuous(limits=c(0,102))
PLOT_EDU.BETA
scratch.m<-filter(in_vitro_experiments,Experiment=="Scratch" & Observation == "Proliferation" & !grepl(x = as.character(in_vitro_experiments$Treatment),pattern = "CONTROL_")) %>% dplyr::select(-c(Experiment,Coverslip))
tail(in_vitro_experiments,n = 20)
names(scratch.m)<-c("Observation","BCS","ExposureTime","percent_cells","Field")
scratch.m$BCS<-factor(scratch.m$BCS,ordered = T,levels = c("L. crispatus","L. jensenii","L. iners","G. vaginalis","Cell Culture Medium","0.1% DL lactic acid"))
scratch_sigtest.all<-data.frame(temp<-"NA")
scratch.summary.all<-data.frame(temp<-"NA")
for(et in c("1hr","4hr","8hr","13hr","16hr","19hr","22hr")){
##FIXME this is sloppy
##Ignore sig tests for now since the plots are clearly sig... too many comparisons
## Create a significance testing data frame to hold results
setup_sigtest.data<-setup_sigtest(pval_threshold = pval_threshold,raw_data = dplyr::filter(scratch.m,ExposureTime==et),test_function = "t.test",Experiment = "Scratch")
scratch_sigtest<-setup_sigtest.data$sigtest
scratch_sigtest$ExposureTime<-et
scratch.summary<-setup_sigtest.data$summary_stats
scratch.summary$ExposureTime.n<-as.numeric(gsub(et,pattern = "hr",replacement = ""))
scratch_sigtest.all<-rbind.fill(scratch_sigtest,scratch_sigtest.all)
scratch.summary.all<-rbind.fill(scratch.summary,scratch.summary.all)
}
PLOT_SCRATCH.BETA<-
ggplot(scratch.summary.all,
aes(x=ExposureTime.n,y=mean,col=BCS))+
theme_bw()+
theme(plot.margin=unit(c(0,0,0,0),units = "pt"), text=element_text(size=16))+
geom_line(size=1.5,show.legend = F)+
geom_errorbar(aes(ymax=mean+sd,ymin=mean-sd),size=1,width=.5,show.legend = F)+
geom_point(size=6,show.legend = F)+
ylab("Filled Scratch Area (%)")+
mBio+
xlab("Exposure Time (hours)")+
scale_color_manual(values = color_scheme_BCS)+
scale_x_continuous(breaks=c(1,4,8,13,16,19,22),minor_breaks = NULL,limits=c(0,22.5))+
scale_y_continuous(limits=c(1.05*min(scratch.summary.all$mean-scratch.summary.all$sd,na.rm = T),102))
PLOT_SCRATCH.BETA
save(in_vitro_experiments,file=paste0(R_script_input_directory,"In_Vitro_Experiments.Rdata"))
root_directory<-"~/smith_thesis_2017/PreparePipeline/"
R_script_input_directory<-"~/smith_thesis_2017/AnalysisPipeline/Script_input/"
in_vitro_experiments<-read.csv(paste0(root_directory,"In_vitro_Experiments.csv")) ## pre-compiled csv datatable.
save(in_vitro_experiments,file=paste0(R_script_input_directory,"In_Vitro_Experiments.Rdata"))
scratch.m<-filter(in_vitro_experiments,Experiment=="Scratch" & Observation == "Proliferation" & !grepl(x = as.character(in_vitro_experiments$Treatment),pattern = "CONTROL_")) %>% dplyr::select(-c(Experiment,Coverslip))
table(in_vitro_experiments)
table(in_vitro_experiments$Observation)
table(in_vitro_experiments$ExposureTime)
table(paste(in_vitro_experiments$Treatment,in_vitro_experiments$ExposureTime))
write.csv(table(paste(in_vitro_experiments$Treatment,in_vitro_experiments$ExposureTime)),"~/Desktop/tab.csv")
in_vitro_experiments
write.csv(table(paste(in_vitro_experiments$Experiment,in_vitro_experiments$Observation,in_vitro_experiments$Treatment,in_vitro_experiments$ExposureTime)),"~/Desktop/tab.csv")
